// Minimal Van.js implementation
const van = (() => {
  const state = (initVal) => {
    let val = initVal;
    const listeners = [];
    
    const stateObj = {
      get val() { return val; },
      set val(newVal) {
        val = newVal;
        listeners.forEach(l => l());
      }
    };
    
    stateObj.addListener = (listener) => listeners.push(listener);
    return stateObj;
  };

  const createElement = (tag) => (...args) => {
    const el = document.createElement(tag);
    
    args.forEach(arg => {
      if (typeof arg === 'string') {
        el.textContent = arg;
      } else if (typeof arg === 'function') {
        const update = () => el.textContent = arg();
        update();
        // Simple reactive binding
        setTimeout(() => {
          const states = [];
          try { arg(); } catch(e) {}
          setInterval(update, 100); // Simple polling
        }, 0);
      } else if (arg && typeof arg === 'object' && !arg.nodeType) {
        Object.entries(arg).forEach(([key, value]) => {
          if (key === 'onclick') {
            el.addEventListener('click', value);
          } else if (key === 'class') {
            if (typeof value === 'function') {
              const update = () => el.className = value();
              update();
              setInterval(update, 100);
            } else {
              el.className = value;
            }
          } else {
            el.setAttribute(key, value);
          }
        });
      } else if (arg && arg.nodeType) {
        el.appendChild(arg);
      }
    });
    
    return el;
  };

  const add = (parent, child) => {
    parent.appendChild(child);
  };

  return {
    state,
    add,
    tags: {
      div: createElement('div'),
      button: createElement('button'),
      span: createElement('span'),
      p: createElement('p'),
      h1: createElement('h1'),
      h2: createElement('h2'),
      h3: createElement('h3')
    }
  };
})();